var w=r=>{throw TypeError(r)};var L=(r,e,t)=>e.has(r)||w("Cannot "+t);var i=(r,e,t)=>(L(r,e,"read from private field"),t?t.call(r):e.get(r)),y=(r,e,t)=>e.has(r)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),v=(r,e,t,o)=>(L(r,e,"write to private field"),o?o.call(r,t):e.set(r,t),t);import{S as N,i as P}from"./assets/vendor-ViPvZOva.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const f of n.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();var a,u;class V{constructor(e={}){y(this,a,{});y(this,u,{});v(this,a,{...e})}getState(e){return i(this,a)[e]}setState(e,t){i(this,a)[e]!==t&&(i(this,a)[e]=t,this.notify(e))}subscribe(e,t){i(this,u)[e]||(i(this,u)[e]=[]),i(this,u)[e].push(t),t(i(this,a)[e],i(this,a))}notify(e){if(i(this,u)[e])for(const t of i(this,u)[e])t(i(this,a)[e],i(this,a))}}a=new WeakMap,u=new WeakMap;const z="https://us-central1-dev-test-448809.cloudfunctions.net/pixabayProxy/";function A(r){const e=new URLSearchParams({q:encodeURIComponent(r),image_type:"photo",orientation:"horizontal",safesearch:"true",per_page:"9",page:"1"}),t=`${z}?${e}`;return fetch(t).then(o=>{if(!o.ok)throw new Error(`Error fetching images: ${o.statusText}`);return o.json()}).catch(o=>{throw console.error("Error:",o),o})}function K(r){const e=document.querySelector(".loader");return r?e==null||e.classList.remove("hidden"):e==null||e.classList.add("hidden"),e}function C(r,e){const t=document.querySelector(".gallery");e?t==null||t.classList.add("hidden"):t==null||t.classList.remove("hidden");const o=Array.from(t.querySelectorAll("a.gallery-link")).map(c=>c.dataset.id),s=r.map(c=>c.id);if(o.join("|")===s.join("|"))return;const n=document.querySelector("#gallery-item-template"),f=document.createDocumentFragment();if(r.forEach(({id:c,webformatURL:p,largeImageURL:S,tags:b,likes:O,comments:$,views:D,downloads:F})=>{const d=n.content.cloneNode(!0),q=d.querySelector("a.gallery-link"),h=d.querySelector("img.gallery-image");q.dataset.id=c,q.href=S,h.src=p,h.alt=b,h.title=b,h.dataset.source=S;const m=d.querySelector(".gallery-item-meta"),M=m.querySelector(".meta-likes-value"),_=m.querySelector(".meta-views-value"),j=m.querySelector(".meta-comments-value"),I=m.querySelector(".meta-downloads-value");M.textContent=`${O||0}`,_.textContent=`${D||0}`,j.textContent=`${$||0}`,I.textContent=`${F||0}`,f.appendChild(d)}),t.innerHTML="",t.appendChild(f),t._instance)t._instance.refresh();else{const c=new N(".gallery a",{captions:!0,captionDelay:250,captionPosition:"bottom"});c.on("show.simplelightbox",function(...p){}),c.on("error.simplelightbox",function(...p){}),t._instance=c}}P.settings({position:"topRight",timeout:2e3,close:!1,progressBar:!1,transitionIn:"bounceInUp",transitionOut:"fadeOutDown"});const x={success:"#4caf50",error:"#f44336"},T={success:"fas fa-check",error:"fas fa-ban"};function g(r,e="success"){P[e]({message:r,icon:T[e]||"fas fa-info",iconColor:x[e]||"#ddd",progressBarColor:x[e]||"#ddd"})}const l=new V({loading:!1,images:[],search:""});l.subscribe("loading",K);l.subscribe("loading",(r,{images:e})=>C(e,r));l.subscribe("images",(r,{loading:e})=>C(r,e));function U(){const r=document.querySelector(".form");r==null||r.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(r),o=Object.fromEntries(t.entries());if(!o.search){g("Please enter a search query","error");return}if(o.search===l.getState("search")){g(`You already searched for "${o.search}"`,"error");return}l.setState("loading",!0),l.setState("search",o.search),A(o.search).then(s=>{if(s.hits.length===0){g("Sorry, there are no images matching your search query. Please try again!","error");return}l.setState("images",s.hits)}).catch(s=>{console.error("Error fetching images:",s),g("Error fetching images","error")}).finally(()=>{l.setState("loading",!1)})})}U();
